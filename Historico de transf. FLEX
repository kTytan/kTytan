SELECT P.CODUSUR,
       U.NOME,
       CAST(SUM(P.VLTABELA) AS NUMERIC(10, 2)) AS VLTABELA,
       CAST(SUM(P.VLATEND) AS NUMERIC(10, 2)) AS VLATEND,
       CAST(SUM(P.VLTABELA) - SUM(P.VLATEND) AS NUMERIC(10, 2)) AS VLDESCONTO,
       CAST(L.VLCORRENTE - L.VLCORRENTEANT AS NUMERIC(10, 2)) AS VLFLEX

  FROM PCUSUARI U, PCPEDC P, PCLOGRCA L
 WHERE P.CODUSUR = U.CODUSUR
   AND P.CODUSUR = L.CODUSUR
   AND U.CODUSUR = L.CODUSUR
   AND L.ROTINA = 356
   AND P.DATA BETWEEN '01/01/2022' AND '31/01/2022'
   AND L.DATA BETWEEN '01/01/2022' AND '31/01/2022'
   AND P.POSICAO IN ('P', 'L', 'B', 'F', 'M')
   AND P.CODUSUR NOT IN (6, 8, 16, 901)
 GROUP BY P.CODUSUR, U.NOME, L.CODUSUR, L.VLCORRENTE, L.VLCORRENTEANT
 ORDER BY P.CODUSUR;
------------------------------------
--///////////////////////////--
------------------------------------

SELECT DISTINCT(L.CODUSUR) AS RCA,
      CAST(SUM(L.VLCORRENTE) - SUM(L.VLCORRENTEANT) AS NUMERIC(10,2)) AS VLLANC
      
  FROM PCLOGRCA L
 WHERE L.DATA BETWEEN '01/01/2022' AND '31/01/2022'
   AND L.ROTINA = 356
   AND L.CODUSUR NOT IN (100, 901)
   GROUP BY L.CODUSUR
ORDER BY L.CODUSUR;
